<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ahutoj.dao.ahutojForum.SolutionDao">
    <select id="getSolutions" resultType="com.ahutoj.bean.Solution">
        select *
        from solution
        <trim prefix="where" suffixOverrides="and|or">
            <if test="PID != null and PID !=''">
                PID = #{PID} and
            </if>
            <if test="UID != null and UID !=''">
                UID = #{UID} and
            </if>
            <if test="State != null">
                State = #{State} and
            </if>
        </trim>
        limit ${Begin},${Limit};
    </select>

    <delete id="deleteSolution">
        delete
        from solution
        where SLTID = #{SLTID};
    </delete>

    <select id="getSolutionsCountByPID" resultType="_integer">
        select count(*)
        from solution
        <trim prefix="where" suffixOverrides="and|or">
            <if test="PID != null and PID !=''">
                PID = #{PID} and
            </if>
            <if test="State != null">
                State = #{State} and
            </if>
        </trim>
    </select>

    <insert id="addSolution">
        insert into solution(SLTID, UID, PID, Content, UpdateTime)
        values (null, #{UID}, #{PID}, #{Content}, #{UpdateTime})
    </insert>

    <update id="changeSolutionContent">
        update solution
        set Content    = #{Content},
            UpdateTime = #{UpdateTime}
        where SLTID = #{SLTID};
    </update>

    <update id="changeSolutionThumbUp">
        update solution
        set ThumbsUp = ThumbsUp + #{Interval}
        where SLTID = #{SLTID};
    </update>

    <update id="changeSolutionState">
        update solution
        set State = #{State}
    </update>
</mapper>